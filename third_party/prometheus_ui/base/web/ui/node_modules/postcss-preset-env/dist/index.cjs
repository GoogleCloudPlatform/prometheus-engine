"use strict";var e=require("autoprefixer"),s=require("cssdb"),t=require("@csstools/postcss-progressive-custom-properties"),o=require("fs"),r=require("path"),i=require("browserslist"),n=require("postcss-attribute-case-insensitive"),c=require("css-blank-pseudo"),u=require("postcss-color-functional-notation"),a=require("postcss-color-hex-alpha"),l=require("postcss-color-rebeccapurple"),p=require("postcss-custom-media"),f=require("postcss-custom-properties"),d=require("postcss-custom-selectors"),m=require("postcss-dir-pseudo-class"),g=require("postcss-double-position-gradients"),b=require("postcss-env-function"),h=require("postcss-focus-visible"),y=require("postcss-focus-within"),w=require("postcss-font-variant"),v=require("postcss-gap-properties"),$=require("css-has-pseudo"),q=require("postcss-image-set-function"),k=require("postcss-initial"),O=require("postcss-lab-function"),S=require("postcss-logical"),j=require("postcss-media-minmax"),x=require("postcss-nesting"),E=require("postcss-overflow-shorthand"),P=require("postcss-page-break"),M=require("postcss-place"),_=require("css-prefers-color-scheme"),R=require("postcss-pseudo-class-any-link"),A=require("postcss-replace-overflow-wrap"),F=require("postcss-selector-not"),T=require("@csstools/postcss-is-pseudo-class"),U=require("@csstools/postcss-hwb-function"),N=require("postcss-opacity-percentage"),B=require("postcss-clamp"),W=require("@csstools/postcss-font-format-keywords"),C=require("@csstools/postcss-normalize-display-values"),I=require("@csstools/postcss-color-function"),V=require("@csstools/postcss-oklab-function"),D=require("@csstools/postcss-ic-unit");function L(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var J=L(e),z=L(s),G=L(t),H=L(o),K=L(r),Q=L(i),X=L(n),Y=L(c),Z=L(u),ee=L(a),se=L(l),te=L(p),oe=L(f),re=L(d),ie=L(m),ne=L(g),ce=L(b),ue=L(h),ae=L(y),le=L(w),pe=L(v),fe=L($),de=L(q),me=L(k),ge=L(O),be=L(S),he=L(j),ye=L(x),we=L(E),ve=L(P),$e=L(M),qe=L(_),ke=L(R),Oe=L(A),Se=L(F),je=L(T),xe=L(U),Ee=L(N),Pe=L(B),Me=L(W),_e=L(C),Re=L(I),Ae=L(V),Fe=L(D);const Te={"blank-pseudo-class":"https://github.com/csstools/postcss-plugins/blob/main/plugins/css-blank-pseudo/README-BROWSER.md","focus-visible-pseudo-class":"https://github.com/WICG/focus-visible","focus-within-pseudo-class":"https://github.com/jsxtools/focus-within/blob/master/README-BROWSER.md","has-pseudo-class":"https://github.com/csstools/postcss-plugins/blob/main/plugins/css-has-pseudo/README-BROWSER.md","prefers-color-scheme-query":"https://github.com/csstools/postcss-plugins/blob/main/plugins/css-prefers-color-scheme/README-BROWSER.md"},Ue=["blank-pseudo-class","focus-visible-pseudo-class","focus-within-pseudo-class","has-pseudo-class","prefers-color-scheme-query"];async function Ne(e,s,t,o){const r=function(e){return`:root {\n${Object.keys(e).reduce(((s,t)=>(s.push(`\t${t}: ${e[t]};`),s)),[]).join("\n")}\n}\n`}(t),i=function(e){return`${Object.keys(e).reduce(((s,t)=>(s.push(`@custom-media ${t} ${e[t]};`),s)),[]).join("\n")}\n`}(s),n=function(e){return`${Object.keys(e).reduce(((s,t)=>(s.push(`@custom-selector ${t} ${e[t]};`),s)),[]).join("\n")}\n`}(o),c=`${i}\n${n}\n${r}`;await Ve(e,c)}function Be(e,s){return`\n\t${e}: {\n${Object.keys(s).reduce(((e,t)=>(e.push(`\t\t'${De(t)}': '${De(s[t])}'`),e)),[]).join(",\n")}\n\t}`}function We(e,s){return`export const ${e} = {\n${Object.keys(s).reduce(((e,t)=>(e.push(`\t'${De(t)}': '${De(s[t])}'`),e)),[]).join(",\n")}\n};\n`}function Ce(e,s){return Promise.all([].concat(s).map((async s=>{if(s instanceof Function)await s({customMedia:Ie(e.customMedia),customProperties:Ie(e.customProperties),customSelectors:Ie(e.customSelectors)});else{const t=s===Object(s)?s:{to:String(s)},o=t.toJSON||Ie;if("customMedia"in t||"customProperties"in t||"customSelectors"in t)t.customMedia=o(e.customMedia),t.customProperties=o(e.customProperties),t.customSelectors=o(e.customSelectors);else if("custom-media"in t||"custom-properties"in t||"custom-selectors"in t)t["custom-media"]=o(e.customMedia),t["custom-properties"]=o(e.customProperties),t["custom-selectors"]=o(e.customSelectors);else{const s=String(t.to||""),r=(t.type||K.default.extname(t.to).slice(1)).toLowerCase(),i=o(e.customMedia),n=o(e.customProperties),c=o(e.customSelectors);"css"===r&&await Ne(s,i,n,c),"js"===r&&await async function(e,s,t,o){const r=`module.exports = {${Be("customMedia",s)},${Be("customProperties",t)},${Be("customSelectors",o)}\n};\n`;await Ve(e,r)}(s,i,n,c),"json"===r&&await async function(e,s,t,o){const r=`${JSON.stringify({"custom-media":s,"custom-properties":t,"custom-selectors":o},null,"  ")}\n`;await Ve(e,r)}(s,i,n,c),"mjs"===r&&await async function(e,s,t,o){const r=`${We("customMedia",s)}\n${We("customProperties",t)}\n${We("customSelectors",o)}`;await Ve(e,r)}(s,i,n,c)}}})))}function Ie(e){return Object.keys(e).reduce(((s,t)=>(s[t]=String(e[t]),s)),{})}function Ve(e,s){return new Promise(((t,o)=>{H.default.writeFile(e,s,(e=>{e?o(e):t()}))}))}function De(e){return e.replace(/\\([\s\S])|(')/g,"\\$1$2").replace(/\n/g,"\\n").replace(/\r/g,"\\r")}function Le(e,s){if(!e)return!1;if("string"==typeof e)return!0;if(Array.isArray(e)){for(let t=0;t<e.length;t++){if("string"==typeof e[t])return!0;if(e[t]&&s in Object(e[t]))return!0}return!1}return s in Object(e)}function Je(e,s,t){return Math.max(e,Math.min(s,t))}const ze=Symbol("insertBefore"),Ge=Symbol("insertAfter"),He=Symbol("insertOrder"),Ke=Symbol("plugin");function Qe(e,s,t){if("insertBefore"!==t&&"insertAfter"!==t)return[];const o="insertBefore"===t?ze:Ge,r=[];for(const t in s){if(!Object.hasOwnProperty.call(s,t))continue;if(!e.find((e=>e.id===t)))continue;let i=s[t];Array.isArray(i)||(i=[i]);for(let e=0;e<i.length;e++)r.push({id:t,[Ke]:i[e],[He]:e,[o]:!0})}return r}var Xe=["custom-media-queries","custom-properties","environment-variables","image-set-function","media-query-ranges","prefers-color-scheme-query","nesting-rules","custom-selectors","any-link-pseudo-class","case-insensitive-attributes","focus-visible-pseudo-class","focus-within-pseudo-class","not-pseudo-class","logical-properties-and-values","dir-pseudo-class","all-property","color-functional-notation","double-position-gradients","hexadecimal-alpha-notation","hwb-function","lab-function","rebeccapurple-color","blank-pseudo-class","break-properties","font-variant-property","is-pseudo-class","has-pseudo-class","gap-properties","overflow-property","overflow-wrap-property","place-properties","system-ui-font-family"];function Ye(){return{postcssPlugin:"postcss-system-ui-font",Declaration(e){Ze.test(e.prop)&&(e.value.includes(ss.join(", "))||(e.value=e.value.replace(ts,os)))}}}Ye.postcss=!0;const Ze=/(?:^(?:-|\\002d){2})|(?:^font(?:-family)?$)/i,es="[\\f\\n\\r\\x09\\x20]",ss=["system-ui","-apple-system","Segoe UI","Roboto","Ubuntu","Cantarell","Noto Sans","sans-serif"],ts=new RegExp(`(^|,|${es}+)(?:system-ui${es}*)(?:,${es}*(?:${ss.join("|")})${es}*)?(,|$)`,"i"),os=`$1${ss.join(", ")}$2`,rs=new Map([["all-property",me.default],["any-link-pseudo-class",ke.default],["blank-pseudo-class",Y.default],["break-properties",ve.default],["case-insensitive-attributes",X.default],["clamp",Pe.default],["color-function",Re.default],["color-functional-notation",Z.default],["custom-media-queries",te.default],["custom-properties",oe.default],["custom-selectors",re.default],["dir-pseudo-class",ie.default],["display-two-values",_e.default],["double-position-gradients",ne.default],["environment-variables",ce.default],["focus-visible-pseudo-class",ue.default],["focus-within-pseudo-class",ae.default],["font-format-keywords",Me.default],["font-variant-property",le.default],["gap-properties",pe.default],["hwb-function",xe.default],["has-pseudo-class",fe.default],["hexadecimal-alpha-notation",ee.default],["ic-unit",Fe.default],["image-set-function",de.default],["is-pseudo-class",je.default],["lab-function",ge.default],["logical-properties-and-values",be.default],["media-query-ranges",he.default],["nesting-rules",ye.default],["not-pseudo-class",Se.default],["oklab-function",Ae.default],["opacity-percentage",Ee.default],["overflow-property",we.default],["overflow-wrap-property",Oe.default],["place-properties",$e.default],["prefers-color-scheme-query",qe.default],["rebeccapurple-color",se.default],["system-ui-font-family",Ye]]);function is(e,s,t){return e.concat(Qe(e,s,"insertBefore"),Qe(e,t,"insertAfter")).filter((e=>function(e){return!!e[ze]||!!e[Ge]||!!rs.has(e.id)}(e))).sort(((e,s)=>function(e,s){return e.id===s.id?e[ze]&&s[ze]||e[Ge]&&s[Ge]?Je(-1,e[He]-s[He],1):e[ze]||s[Ge]?-1:e[Ge]||s[ze]?1:0:Je(-1,Xe.indexOf(e.id)-Xe.indexOf(s.id),1)}(e,s)))}const ns=["ie","edge","firefox","chrome","safari","opera","ios_saf","android","op_mob","and_chr","and_ff","and_uc","samsung","and_qq","baidu","kaios"];function cs(e){if(!e)return[];if(!("browser_support"in e))return["> 0%"];const s=[];return ns.forEach((t=>{const o=e.browser_support[t];"string"==typeof o&&/^[0-9|.]+$/.test(o)?s.push(`${t} < ${e.browser_support[t]}`):s.push(`${t} >= 1`)})),s}function us(e,s,t,o){const r=Q.default(e,{ignoreUnknownVersions:!0});switch(s.id){case"is-pseudo-class":return{onComplexSelector:"warning"};case"nesting-rules":if(function(e,s){const t=cs(e);if(s.some((e=>Q.default(t,{ignoreUnknownVersions:!0}).some((s=>s===e)))))return!0;return!1}(t.find((e=>"is-pseudo-class"===e.id)),r))return o.log('Disabling :is on "nesting-rules" due to lack of browser support.'),{noIsPseudoSelector:!0};return{};case"any-link-pseudo-class":if(r.find((e=>e.startsWith("ie ")||e.startsWith("edge "))))return o.log('Adding area[href] fallbacks for ":any-link" support in Edge and IE.'),{subFeatures:{areaHrefNeedsFixing:!0}};return{};default:return{}}}function as(e,s,t,o){const r=Object(s.features),i=!("enableClientSidePolyfills"in s)||s.enableClientSidePolyfills,n=Object(s.insertBefore),c=Object(s.insertAfter),u=s.browsers,a=Je(0,function(e){const s=parseInt(e,10);return Number.isNaN(s)?0:s}(s.minimumVendorImplementations),3);a>0&&o.log(`Using features with ${a} or more vendor implementations`);const l=function(e,s){let t=2;if(void 0===e.stage)return s.log(`Using features from Stage ${t} (default)`),t;if(!1===e.stage)t=5;else{let s=parseInt(e.stage,10);Number.isNaN(s)&&(s=0),t=Je(0,s,5)}return 5===t?s.log('Stage has been disabled, features will be handled via the "features" option.'):s.log(`Using features from Stage ${t}`),t}(s,o);2===l&&t&&!1===t.preserve&&(e=JSON.parse(JSON.stringify(e))).forEach((e=>{("blank-pseudo-class"===e.id||"prefers-color-scheme-query"===e.id)&&(e.stage=1)}));const p=is(e,n,c).map((e=>function(e){const s=cs(e);if(e[ze]||e[Ge]){let t=e.id;return t=e.insertBefore?`before-${t}`:`after-${t}`,{browsers:s,vendors_implementations:e.vendors_implementations,plugin:e[Ke],id:t,stage:6}}return{browsers:s,vendors_implementations:e.vendors_implementations,plugin:rs.get(e.id),id:e.id,stage:e.stage}}(e))).filter((e=>0===a||(!(!e[ze]&&!e[Ge])||(a<=e.vendors_implementations||(r[e.id]?(o.log(`  ${e.id} does not meet the required vendor implementations but has been enabled by options`),!0):(o.log(`  ${e.id} with ${e.vendors_implementations} vendor implementations has been disabled`),!1)))))).filter((e=>{const s=e.stage>=l,t=i||!Ue.includes(e.id),n=!1===r[e.id],c=r[e.id]?r[e.id]:s&&t;return n?o.log(`  ${e.id} has been disabled by options`):s?t||o.log(`  ${e.id} has been disabled by "enableClientSidePolyfills: false".`):c?o.log(`  ${e.id} does not meet the required stage but has been enabled by options`):o.log(`  ${e.id} with stage ${e.stage} has been disabled`),c})).map((s=>function(e,s,t,o,r,i){let n,c;return n=us(s,o,e,i),!0===t[o.id]?r&&(n=Object.assign({},n,r)):n=r?Object.assign({},n,r,t[o.id]):Object.assign({},n,t[o.id]),n.enableProgressiveCustomProperties=!1,c=o.plugin.postcss&&"function"==typeof o.plugin?o.plugin(n):o.plugin&&o.plugin.default&&"function"==typeof o.plugin.default&&o.plugin.default.postcss?o.plugin.default(n):o.plugin,{browsers:o.browsers,vendors_implementations:o.vendors_implementations,plugin:c,pluginOptions:n,id:o.id}}(e,u,r,s,t,o))),f=Q.default(u,{ignoreUnknownVersions:!0});return p.filter((e=>{if(e.id in r)return r[e.id];if(function(e){if("importFrom"in Object(e.pluginOptions))switch(e.id){case"custom-media-queries":if(Le(e.pluginOptions.importFrom,"customMedia"))return!0;break;case"custom-properties":if(Le(e.pluginOptions.importFrom,"customProperties"))return!0;break;case"environment-variables":if(Le(e.pluginOptions.importFrom,"environmentVariables"))return!0;break;case"custom-selectors":if(Le(e.pluginOptions.importFrom,"customSelectors"))return!0}if("exportTo"in Object(e.pluginOptions))switch(e.id){case"custom-media-queries":if(Le(e.pluginOptions.exportTo,"customMedia"))return!0;break;case"custom-properties":if(Le(e.pluginOptions.exportTo,"customProperties"))return!0;break;case"environment-variables":if(Le(e.pluginOptions.exportTo,"environmentVariables"))return!0;break;case"custom-selectors":if(Le(e.pluginOptions.exportTo,"customSelectors"))return!0}return!1}(e))return!0;const s=Q.default(e.browsers,{ignoreUnknownVersions:!0}),t=f.some((e=>s.some((s=>s===e))));return t||o.log(`${e.id} disabled due to browser support`),t}))}class ls{constructor(){this.logs=[]}log(e){this.logs.push(e)}resetLogger(){this.logs.length=0}dumpLogs(e){e&&this.logs.forEach((s=>e.warn(s))),this.resetLogger()}}const ps={"css-blank-pseudo":"blank-pseudo-class","css-has-pseudo":"has-pseudo-class","css-prefers-color-scheme":"prefers-color-scheme-query","postcss-attribute-case-insensitive":"case-insensitive-attributes","postcss-clamp":"clamp","postcss-color-function":"color-function","postcss-color-functional-notation":"color-functional-notation","postcss-color-hex-alpha":"hexadecimal-alpha-notation","postcss-color-rebeccapurple":"rebeccapurple-color","postcss-custom-media":"custom-media-queries","postcss-custom-properties":"custom-properties","postcss-custom-selectors":"custom-selectors","postcss-dir-pseudo-class":"dir-pseudo-class","postcss-double-position-gradients":"double-position-gradients","postcss-env-function":"environment-variables","postcss-focus-visible":"focus-visible-pseudo-class","postcss-focus-within":"focus-within-pseudo-class","postcss-font-format-keywords":"font-format-keywords","postcss-font-variant":"font-variant-property","postcss-gap-properties":"gap-properties","postcss-hwb-function":"hwb-function","postcss-ic-unit":"ic-unit","postcss-image-set-function":"image-set-function","postcss-initial":"all-property","postcss-is-pseudo-class":"is-pseudo-class","postcss-lab-function":"lab-function","postcss-logical":"logical-properties-and-values","postcss-media-minmax":"media-query-ranges","postcss-nesting":"nesting-rules","postcss-normalize-display-values":"display-two-values","postcss-oklab-function":"oklab-function","postcss-opacity-percentage":"opacity-percentage","postcss-overflow-shorthand":"overflow-property","postcss-page-break":"break-properties","postcss-place":"place-properties","postcss-pseudo-class-any-link":"any-link-pseudo-class","postcss-replace-overflow-wrap":"overflow-wrap-property","postcss-selector-not":"not-pseudo-class","postcss-system-ui-font-family":"system-ui-font-family"},fs=(()=>{const e={};for(const[s,t]of Object.entries(ps))e[t]=s;return e})();function ds(e,s){let t="unknown",o=1/0;for(let r=0;r<s.length;r++){const i=ms(e,s[r]);i<o&&(o=i,t=s[r])}return{mostSimilar:t,distance:o}}function ms(e,s){if(!e.length)return s.length;if(!s.length)return e.length;const t=[];for(let o=0;o<=s.length;o++){t[o]=[o];for(let r=1;r<=e.length;r++)t[o][r]=0===o?r:Math.min(t[o-1][r]+1,t[o][r-1]+1,t[o-1][r-1]+(e[r-1]===s[o-1]?0:1))}return t[s.length][e.length]}const gs=e=>{const s=new ls,t=Object(e),o=Object.keys(Object(t.features)),r=t.browsers,i=function(e){if("importFrom"in e||"exportTo"in e||"preserve"in e){const s={};return"importFrom"in e&&(s.importFrom=e.importFrom),"exportTo"in e&&(s.exportTo={customMedia:{},customProperties:{},customSelectors:{}}),"preserve"in e&&(s.preserve=e.preserve),s}return!1}(t),n=as(z.default,t,i,s),c=n.map((e=>e.plugin));!1!==t.autoprefixer&&c.push(J.default(Object.assign({overrideBrowserslist:r},t.autoprefixer))),c.push(G.default()),function(e,s,t){if(s.debug){t.log("Enabling the following feature(s):");const s=[];e.forEach((e=>{e.id.startsWith("before")||e.id.startsWith("after")?t.log(`  ${e.id} (injected via options)`):t.log(`  ${e.id}`),void 0!==Te[e.id]&&s.push(e.id)})),s.length&&(t.log("These feature(s) need a browser library to work:"),s.forEach((e=>t.log(` ${e}: ${Te[e]}`))))}}(n,t,s);const u=()=>({postcssPlugin:"postcss-preset-env",OnceExit:function(r,{result:n}){!function(e,s,t){const o=Object.keys(fs),r=Object.keys(ps);e.forEach((e=>{if(o.includes(e))return;const i=ds(e,o),n=ds(e,r);Math.min(i.distance,n.distance)>10?s.warn(t`Unknown feature: "${e}", see the list of features https://github.com/csstools/postcss-plugins/blob/main/plugin-packs/postcss-preset-env/FEATURES.md`):i.distance<n.distance?s.warn(t,`Unknown feature: "${e}", did you mean: "${i.mostSimilar}"`):s.warn(t,`Unknown feature: "${e}", did you mean: "${ps[n.mostSimilar]}"`)}))}(o,r,n),t.debug&&s.dumpLogs(n),s.resetLogger(),t.exportTo&&Ce(i.exportTo,e.exportTo)}});return u.postcss=!0,{postcssPlugin:"postcss-preset-env",plugins:[...c,u()]}};gs.postcss=!0,module.exports=gs;
